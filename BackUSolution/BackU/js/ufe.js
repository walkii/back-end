function ufeInit(a){ufe.Init(a)}function ufeLoadComplete(){ufe.LoadComplete()}function ufeEditComplete(a){ufe.EditComplete(a)}var ufeLocalize=null,ufe={PageId:0,SlideDuration:400,FadeDuration:200,State:null,Edit:null,Create:null,UnPublish:null,Delete:null,Login:null,Logout:null,Frame:null,LoginPanel:null,CreatePanel:null,UnPublishPanel:null,DeletePanel:null,ContentTypeSelector:null,Active:null,Controls:null};ufe.LoadComplete=function(){this.SetPageForEditing(!0),this.GoToProperty(this.PropertyAlias),this.Frame.slideDown(this.SlideDuration,function(){ufe.SetOpen(),ufe.SetReady()})},ufe.EditComplete=function(a){this.IsOpen()&&(this.SetBusy(),this.Frame.slideUp(this.SlideDuration,function(){location.assign(a)}))},ufe.IsOpen=function(){return this.Frame.is(":visible")},ufe.Init=function(a){this.PageId=a},ufe.SetBusy=function(){this.Active.addClass("ufe_busy")},ufe.SetReady=function(){this.Active.removeClass("ufe_busy")},ufe.SetOpen=function(){this.Active.addClass("ufe_open")},ufe.SetClosed=function(){this.Active.removeClass("ufe_open"),$(this.Controls).each(function(a,b){$(b).removeClass("ufe_disabled")})},ufe.ClosePanel=function(a){return a.is(":visible")?(a.fadeOut(this.FadeDuration,function(){ufe.SetClosed()}),!0):!1},ufe.SetActive=function(a){$(this.Controls).each(function(a,b){$(b).addClass("ufe_disabled")}),this.Active=a,this.Active.removeClass("ufe_disabled")},ufe.SetState=function(a){return this.State=a,$(this.Controls).each(function(a,b){$(b).removeClass("ufe_allowed ufe_restricted ufe_disabled ufe_hidden")}),0==this.State.Authenticated?(this.Login.removeClass("ufe_hidden"),void $(this.Controls).each(function(a,b){$(b).addClass("ufe_hidden")})):(this.Login.addClass("ufe_hidden"),this.Logout.removeClass("ufe_hidden"),this.SetControlState(this.Edit,this.State.CanEdit),this.SetControlState(this.Create,this.State.CanCreate),this.SetControlState(this.UnPublish,this.State.CanUnPublish),void this.SetControlState(this.Delete,this.State.CanDelete))},ufe.SetControlState=function(a,b){a.addClass(b?"ufe_allowed":"ufe_restricted")},ufe.StatusUrl=function(){return"/umbraco/api/umbracianfrontendediting/editstatus/"+this.PageId},ufe.AuthenticationUrl=function(){return"/umbraco/api/umbracianfrontendediting/authenticated/"},ufe.CreateContentTypeUrl=function(a){return"/umbraco/#/content/content/edit/"+this.PageId+"?doctype="+a+"&create=true&ufe"},ufe.LoadStatus=function(){$.get(this.StatusUrl(),function(a){ufe.SetState(a),ufe.SetReady()})},ufe.EditContent=function(a){0!=this.State.CanEdit&&(this.Active.hasClass("ufe_busy")||this.Edit.hasClass("ufe_disabled")||this.ToggleFrame(this.Edit,"/umbraco#/content/content/edit/"+this.PageId+"?ufe",a))},ufe.GoToProperty=function(){this.Frame[0].contentWindow.angular.element("#Umbracian_FrontendEditing").scope().goToProperty(this.PropertyAlias)},ufe.ToggleFrame=function(a,b,c){this.PropertyAlias=c,this.SetActive(a),this.SetBusy(),this.IsOpen()?(this.SetPageForEditing(!1),this.Frame.slideUp(this.SlideDuration,function(){ufe.SetClosed(),ufe.SetReady()})):$.get(this.AuthenticationUrl(),function(a){1==a?ufe.Frame.attr("src")&&0==ufe.Frame.attr("src").indexOf(b)?ufe.LoadComplete():ufe.Frame.attr("src",b):ufe.LoadStatus()})},ufe.SetPageForEditing=function(a){var b=$("body"),c="ufe_active";a?b.addClass(c):b.removeClass(c)},ufe.Localize=function(){ufeLocalize&&ufeLocalize.GetText&&(this.LocalizeElements("title"),this.LocalizeElements("placeholder"),this.LocalizeElements("text"),this.LocalizeElements("html"))},ufe.LocalizeElements=function(a){$("[data-ufelocalize-"+a+"]").each(function(b,c){var d=$(c),e=d.data("ufelocalize-"+a),f=ufeLocalize.GetText(e);if(null==f||""==f)console.warn("No localized text returned for key",e);else switch(a){case"title":case"placeholder":d.attr(a,f);break;case"html":d.html(f);break;case"text":d.text(f)}})},ufe.PageLoad=function(){this.Edit=$("#ufe_edit"),this.Create=$("#ufe_create"),this.UnPublish=$("#ufe_unpublish"),this.Delete=$("#ufe_delete"),this.Login=$("#ufe_login"),this.Logout=$("#ufe_logout"),this.Frame=$("#ufe_frame"),this.LoginPanel=$("#ufe_loginpanel"),this.CreatePanel=$("#ufe_createpanel"),this.UnPublishPanel=$("#ufe_unpublishpanel"),this.DeletePanel=$("#ufe_deletepanel"),this.ContentTypeSelector=$("#ufe_contenttypeselector"),this.Controls=[this.Edit,this.Create,this.UnPublish,this.Delete,this.Logout],this.Active=this.Login,this.SetBusy(),this.LoadStatus(),this.Edit.click(function(a){a.preventDefault(),0!=ufe.State.CanEdit&&(ufe.Active.hasClass("ufe_busy")||ufe.Edit.hasClass("ufe_disabled")||ufe.ToggleFrame(ufe.Edit,"/umbraco#/content/content/edit/"+ufe.PageId+"?ufe"))}),this.Create.click(function(a){if(a.preventDefault(),0!=ufe.State.CanCreate&&!ufe.ClosePanel(ufe.CreatePanel)&&!ufe.Active.hasClass("ufe_busy")&&!ufe.Create.hasClass("ufe_disabled")){if(ufe.IsOpen()&&ufe.ContentTypeSelector.val())return void ufe.ToggleFrame(ufe.Create,ufe.CreateContentTypeUrl(ufe.ContentTypeSelector.val()));ufe.SetActive(ufe.Create),ufe.SetOpen(),ufe.ContentTypeSelector.empty();var b="";$(ufe.State.AllowedContentTypes).each(function(a,c){b+="<option value='"+c.Alias+"'>"+c.Name+"</option>"}),ufe.ContentTypeSelector.append(b),ufe.CreatePanel.fadeIn(ufe.FadeDuration)}}),this.Delete.click(function(a){a.preventDefault(),0!=ufe.State.CanDelete&&(ufe.ClosePanel(ufe.DeletePanel)||ufe.Active.hasClass("ufe_busy")||ufe.Delete.hasClass("ufe_disabled")||(ufe.SetActive(ufe.Delete),ufe.SetOpen(),ufe.DeletePanel.fadeIn(ufe.FadeDuration)))}),this.UnPublish.click(function(a){a.preventDefault(),0!=ufe.State.CanUnPublish&&(ufe.ClosePanel(ufe.UnPublishPanel)||ufe.Active.hasClass("ufe_busy")||ufe.UnPublish.hasClass("ufe_disabled")||(ufe.SetActive(ufe.UnPublish),ufe.SetOpen(),ufe.UnPublishPanel.fadeIn(ufe.FadeDuration)))}),$("#ufe_createcontent").click(function(a){a.preventDefault(),ufe.SetBusy(),ufe.CreatePanel.fadeOut(ufe.FadeDuration,function(){ufe.ToggleFrame(ufe.Create,ufe.CreateContentTypeUrl(ufe.ContentTypeSelector.val()))})}),$("#ufe_unpublishcontent").click(function(a){a.preventDefault(),ufe.SetBusy(),ufe.UnPublishPanel.fadeOut(ufe.FadeDuration,function(){$.post("/umbraco/api/umbracianfrontendediting/unpublish/"+ufe.PageId,function(a){1==a.UnPublished?location.assign(a.RedirectUrl):ufe.LoadStatus()}).fail(function(a){console.log("Unpublish failed",a)})})}),$("#ufe_deletecontent").click(function(a){a.preventDefault(),ufe.SetBusy(),ufe.DeletePanel.fadeOut(ufe.FadeDuration,function(){$.post("/umbraco/api/umbracianfrontendediting/delete/"+ufe.PageId,function(a){1==a.Deleted?location.assign(a.RedirectUrl):ufe.LoadStatus()}).fail(function(a){console.log("Delete failed",a)})})}),$(".ufe_cancel").click(function(a){a.preventDefault();var b=$(this).closest(".ufe_panel");b.is(":visible")&&b.fadeOut(ufe.FadeDuration,function(){ufe.SetClosed()})}),$("#ufe_loginuser").click(function(a){a.preventDefault(),ufe.SetBusy(),$.post("/umbraco/api/umbracianfrontendediting/login",{username:$("#ufe_username").val(),password:$("#ufe_password").val()},function(a){1==a?location.reload():($("#ufe_username").addClass("ufe_invalid"),$("#ufe_password").addClass("ufe_invalid"),ufe.SetReady())}).fail(function(a){console.log("Login failed",a)})}),this.Login.click(function(a){a.preventDefault(),ufe.State.Authenticated||ufe.ClosePanel(ufe.LoginPanel)||(ufe.SetActive(ufe.Login),ufe.SetOpen(),ufe.LoginPanel.fadeIn(ufe.FadeDuration))}),this.Logout.click(function(a){a.preventDefault(),ufe.Active.hasClass("ufe_busy")||ufe.Logout.hasClass("ufe_disabled")||(ufe.SetActive(ufe.Logout),ufe.SetBusy(),$.post("/umbraco/api/umbracianfrontendediting/logout",function(a){location.reload()}))})},document.addEventListener("DOMContentLoaded",function(){return window.jQuery?($("body").append('  <div class="ufe_controls">     <a href class="ufe_control" id="ufe_login" title="Login" data-ufelocalize-title="login.control.title"></a>     <a href class="ufe_control ufe_hidden" id="ufe_edit" title="Edit" data-ufelocalize-title="edit.control.title"></a>     <a href class="ufe_control ufe_hidden" id="ufe_create" title="Create" data-ufelocalize-title="create.control.title"></a>     <a href class="ufe_control ufe_hidden" id="ufe_unpublish" title="Unpublish" data-ufelocalize-title="unpublish.control.title"></a>     <a href class="ufe_control ufe_hidden" id="ufe_delete" title="Delete" data-ufelocalize-title="delete.control.title"></a>     <a href class="ufe_control ufe_hidden" id="ufe_logout" title="Logout" data-ufelocalize-title="logout.control.title"></a>   </div>   <div class="ufe_panel" id="ufe_loginpanel">     <p data-ufelocalize-html="login.dialog.text">Please login to start editing.</p>     <form>     <input type="text" id="ufe_username" placeholder="Username" data-ufelocalize-placeholder="login.dialog.username.placeholder" />     <input type="password" id="ufe_password" placeholder="Password" data-ufelocalize-placeholder="login.dialog.password.placeholder" />     <button id="ufe_loginuser" data-ufelocalize-text="login.dialog.button.ok">Login</button>     <button class="ufe_cancel" data-ufelocalize-text="login.dialog.button.cancel">Cancel</button>     </form>   </div>   <div class="ufe_panel" id="ufe_createpanel">     <p data-ufelocalize-html="create.dialog.text">Select which kind of page you want to create:</p>     <select id="ufe_contenttypeselector" />     <button id="ufe_createcontent" data-ufelocalize-text="create.dialog.button.ok">Create</button>     <button class="ufe_cancel" data-ufelocalize-text="create.dialog.button.cancel">Cancel</button>   </div>   <div class="ufe_panel" id="ufe_deletepanel">     <p data-ufelocalize-html="delete.dialog.text">Are you sure you want to <span class="attention">delete</span> this page?</p>     <button id="ufe_deletecontent" data-ufelocalize-text="delete.dialog.button.ok">Yes</button>     <button class="ufe_cancel" data-ufelocalize-text="delete.dialog.button.cancel">No</button>   </div>   <div class="ufe_panel" id="ufe_unpublishpanel">     <p data-ufelocalize-html="unpublish.dialog.text">Are you sure you want to <span class="attention">unpublish</span> this page?</p>     <button id="ufe_unpublishcontent" data-ufelocalize-text="unpublish.dialog.button.ok">Yes</button>     <button class="ufe_cancel" data-ufelocalize-text="unpublish.dialog.button.cancel">No</button>   </div>   <iframe id="ufe_frame">   </iframe>     '),ufe.Localize(),void ufe.PageLoad()):void alert("Error: Frontend Editing requires jQuery loaded on the page.")});